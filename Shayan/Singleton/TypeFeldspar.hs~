{-# OPTIONS_GHC -Wall -fno-warn-orphans #-}
{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, FlexibleContexts #-}
module Type.Feldspar.Singleton where

import Prelude hiding (sin)
import qualified Type.Feldspar.GADT as G
import Singleton
import Control.Applicative ((<$>),(<*>))
import Data.Array (Array)

instance Sin G.Typ Integer where
  sin = return G.Int 
 
instance Sin G.Typ Bool where
  sin = return G.Bol 

instance (Sin G.Typ ta , Sin G.Typ tb) => Sin G.Typ (ta -> tb) where
  sin = G.Arr <$> sin <*> sin
  
instance (Sin G.Typ tf , Sin G.Typ ts) => Sin G.Typ ((tf , ts)) where
  sin = G.Tpl <$> sin <*> sin  
  
instance Sin G.Typ ta => Sin G.Typ (Array Integer ta) where
  sin = G.Ary <$> sin  