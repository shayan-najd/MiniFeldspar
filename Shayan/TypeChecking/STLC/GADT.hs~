{-# OPTIONS_GHC -Wall -fno-warn-orphans #-}
{-# LANGUAGE TypeFamilies #-}
module TypeChecking.STLC.GADT where

import Expression.STLC.GADT
import Type.STLC.GADT        as G
import Environment.GADT as G
import TypeChecking 
 
instance Chk (Exp e t) where
  type Env (Exp e t) = G.Env G.Typ e
  type Mnd (Exp e t) = Monad
  type Typ (Exp e t) = G.Typ t
  chk (Con _)     _ = return Int
  chk (Var x)     r = return (gets x r)
  chk (Abs ta eb) r = do tb <- chk eb (ta `Ext` r)
                         return (ta `Arr` tb)
  chk (App ef _ ) r = do tf <- chk ef r
                         case tf  of 
                           Arr _ tb -> return tb
  chk (Add _  _ ) _ = return Int 